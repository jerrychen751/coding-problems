from math import gcd
import math

# Question 1.1

N = "91PBPNNR46A98XV7MNRP0BTWZAITHTWDKZJ435DL53Y3ULVJJ51S5WCT4LH6O7UXRB0QRCZWWU6BAV96N4L8EUBU99XW7ZIDD1JA5DVXC1WT9168DDHNTRL75I3PIEHMXTO6R3SD2E7G1JY0OIBONVVX038PHDVQQI1OH0UBY5VZZEFJMMC6TSB3SCNVPW8T42O6X4ONNNIKH1KZ9GDKH58UESL0JSGHSQAROL9JBO41OZX4TF2LOPAG3P2PL91BBYV0BD7JX77QH9Z3IZK770UMSGUMNGHIM9RG51L1ZSMRUYNJQ3L8NYKB84RQ9EKUIHZYNYRBRZEKFJP8AJXHDAYNMGDTIVZI3E5ZWMPIDQOK5J3NK7YL4PW3NPJLIU7KBPLFMQE1D57EX1C696193FD09VF6O1SBZVQ2AUDAQIBCPLY2IVRBU02WQEL7ZALA7UCOQL0DM90LG2XRE2SMOCLN0U4XA852XYMCT76A3M0U8H2OMLY16VAVEZC1AL2G97CIH5T9W6XELQ0CPWUK26G8U4MT907VGTD1BVTBWZYRMZPZUXZNM2XSDIIX7WRK97TDZCPPCST9WK0TSW0X70DPX5U687Y13CR1U0EFBFEL53UYLU7EQVQCYZPP0W2QRQ2MX1NAXVDJMCA4KR15CRM6LKL0B8ISCMDP2HGMBPEQYGKNMOOQZOPLOKXHYLVLELKEWOOPGBBTC3RS776Q1F5ARKT5YIDCF8QWDPY76DG1VI3JWEOYBLJLFQB8DYK6E7JHO4J3CDRSPJ9V13P6VUF9N9H5J7"
N = int(N, 36)

def find_smallest_prime_factor(num):
    if num <= 1:
        raise ValueError("No prime factors of numbers <= 1")
    if num % 2 == 0:
        return 2
    limit = int(math.isqrt(num))
    for i in range(3, limit + 1, 2):
        if num % i == 0:
            return i
    return num

# print(find_smallest_prime_factor(N))
# Output: 228645983
p = 228645983

# ===

# Question 1.2
def find_largest_prime_factor(num):
    if num <= 1:
        raise ValueError("No prime factors of numbers <= 1")
    
    last_factor = None
    while num % 2 == 0:
        num = num // 2
        last_factor = 2

    factor = 3
    while factor * factor <= num:
        while num % factor == 0:
            last_factor = factor
            num //= factor
        factor += 1

    if num > 1:
        last_factor = num
    
    return last_factor

# print(find_largest_prime_factor(N))
# print(N // p)
# Output: 934220593594919099460880934121196725503692186730662710213486995557455579125054172047148782513074704240724629136360269817680089157262483982588722900230976713597045742862285143744593471882288180833493539169365850683189454923989452753453825840650828695487908496936615612619238208817734883922663369938815674657555391998309392969163218854499572801971455220932531307029373735768068002743484865479923064215234412868255656561611352137217717394395897986441170640243504528011341689940306672416094516720048707895759748546587296516576167866108575523827013968243309797756607726631612098021474299511606303605334621343958828246210072438373051597333865310713395151531482642034182591690948736081424351578875043023005302616114719218791124534547461523370140501276539319302011463546615587921296730623943049694390418181781611512966347572430923896913096053883263135249659330354708593442269891919914389164715426560936320884733658703836778419466422727196745624035556225694070486273932352933031399910221630941176462707839534239942026521696869960508836030270046084959194139832381129074558985142252719185964869635914637121721048464528220389832707028616059023062801833988803233153792706005381709440211663649848055255708865282466094851194963643207840361480084381
q = 934220593594919099460880934121196725503692186730662710213486995557455579125054172047148782513074704240724629136360269817680089157262483982588722900230976713597045742862285143744593471882288180833493539169365850683189454923989452753453825840650828695487908496936615612619238208817734883922663369938815674657555391998309392969163218854499572801971455220932531307029373735768068002743484865479923064215234412868255656561611352137217717394395897986441170640243504528011341689940306672416094516720048707895759748546587296516576167866108575523827013968243309797756607726631612098021474299511606303605334621343958828246210072438373051597333865310713395151531482642034182591690948736081424351578875043023005302616114719218791124534547461523370140501276539319302011463546615587921296730623943049694390418181781611512966347572430923896913096053883263135249659330354708593442269891919914389164715426560936320884733658703836778419466422727196745624035556225694070486273932352933031399910221630941176462707839534239942026521696869960508836030270046084959194139832381129074558985142252719185964869635914637121721048464528220389832707028616059023062801833988803233153792706005381709440211663649848055255708865282466094851194963643207840361480084381

# ===

# Question 1.3
c = "68G9KYYZ41UATEW4XZ2KO9GJ5SKRLNP7L45J46CTBGRVEFSN7AYW460N3DZJLN3TLJQPIZJIMRX35UY0WQ6X1D9YPV54VBJ8E0AR05234N7W6L767CNAV8RLC6SAFJCUEGN1SOYPCHQ7K439RRXJXF6A3UH3RUWU48RKA5UZ84NDD5NNY0X4URMH4PYTLLJLCPTLFOKZYEIX174RVPDSHJMSG66KYXLHF8N5HNXEP8ORGCZM0KF090UBQGKJYM3FNXIXCOQN7L5ZYKCDKQ7NEFB"
c = int(c, 36)

phi = (p - 1) * (q - 1)
e = 13
d = pow(e, -1, phi) # inverse of e mod phi

m = pow(c, d, N) # decrypted message

# print(m)
# Output: 2198216443646457402785746994097767
m = 2198216443646457402785746994097767

# ===

# Question 1.4
m_bytes = m.to_bytes((m.bit_length() + 7) // 8, 'big')
m_ascii = m_bytes.decode('ascii')

# print(m_ascii)
# Output: ladha.me/a.png

# ===

# Question 2.1, 2.2, 2.3, and 2.4
N1 = "33OZAXSHA2F5E8ZUEN1OZE5XJR6IEECMWPF12IC48FLCLEYB36A8AXVF8HUVP31MPRQ9A4GULCI2A9UBNKI0UJPUWJSN9NLJ5EVNT9H3AGED35HVJNCGVOIEG1P3Q7CE4KZU8IHCTTW72GAB4HO7GUUYEZA0JMPKS2PV65FFUQPQV4Q6XL0ICQS9Z535ZCBC8V23XG885OCMFUHBCZ6U1PKUQJSWX1LTRBRLJUM8M3BGWP3CF6KEU39EYACZQ91GYPXOMZQ788GBC8KSMS5YM7ZATHASIKBQB6GK4VVYOIJJ2JXFK7WP7QQWWLRKUBV8QO1Q5LZR8WQ6CGUAIIOW3DL9VLOK3F142JF8XBEPN22ZS3OU6ENZUVWIS0NJ9SQMPP"
N1 = int(N1, 36)

N2 = "4HXFK86MSEJ0CNAXPOPKCH4LL3EY4L6JZVLSP5F2J9X4AZFOA4OHF0OFBL9ZL7VNEXZ7OAHF3LU541636B12CVHQZ4JTRVZBQ0HSBZY936JLC5HCX18DHKXGU95TJQHT13ZMKZR1JN6DBRZ9SVZ7NBSEGJILB33WDWJ811H677LWU4D3R3HCGWY0P6GB6HAN80DUTASG0NNACJ4Y3YKTN7OLRSRO08PSOEFP1640LD7LSH1QE7MMSYY9QIHCYD5KRWC1HW6T48X565CC95EVEHDYCC8Q9NU21DVP11TWCO0ZIH51LNZRATZBY95HEAYX6Y0IX1IY7DJ1T8QEEHXXIOWTOWR76OAYVCHMUAOZAESIHWMJH5R8LJYHMHNEIRYB5B"
N2 = int(N2, 36)

shared_p = gcd(N1, N2)
q1 = N1 // shared_p
q2 = N2 // shared_p

# print("smaller for N1: ", min(shared_p, q1))
# print("larger for N1: ", max(shared_p, q1))
# print("smaller for N2: ", min(shared_p, q2))
# print("larger for N2: ", max(shared_p, q2))

# Question 3
c = "1DA13590BP05KJ6ZQT3MP3XKM88PB9"
c = int(c, 36)

# Just find m = cbrt(c)
low = 0
high = c
while low <= high:
    mid = low + (high - low) // 2
    if pow(mid, 3) == c:
        print(mid)
        break
    elif pow(mid, 3) < c:
        low = mid + 1
    else:
        high = mid - 1

